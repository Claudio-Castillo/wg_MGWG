library(FLa4a)
setwd('../')
idxs <- readFLIndices('survey.dat')
idxs <- window(idxs, end=2016)
stk <- readFLStock('index.low', no.discards = TRUE)
stk <- window(stk, end=2016)
setwd('a4asca')
fit <- sca(stk, idxs)
res <- residuals(fit, stk, idxs)
plot(res)
fit
fmod <- ~te(age, year, k = c(5, 27), bs = "tp") + s(age, k = 3)
fit <- sca(stk, idxs, fmodel=fmod)
res <- residuals(fit, stk, idxs)
plot(res)
fmod <- ~te(age, year, k = c(5, 27), bs = "tp")# + s(age, k = 3)
fit <- sca(stk, idxs, fmodel=fmod)
res <- residuals(fit, stk, idxs)
plot(res)
plot(stk+fit)
fit <- sca(stk, idxs, fmodel=fmod, srmodel=~s(year, k=20)
res <- residuals(fit, stk, idxs)
plot(res)
fmod <- ~te(age, year, k = c(5, 27), bs = "tp")# + s(age, k = 3)
fit <- sca(stk, idxs, fmodel=fmod, srmodel=~s(year, k=20)
res <- residuals(fit, stk, idxs)
plot(res)
fmod <- ~te(age, year, k = c(5, 27), bs = "tp") # + s(age, k = 3)
fit <- sca(stk, idxs, fmodel=fmod, srmodel=~s(year, k=20))
res <- residuals(fit, stk, idxs)
plot(res)
plot(stk+fit)
fmod <- ~te(age, year, k = c(5, 20), bs = "tp") # + s(age, k = 3)
fit <- sca(stk, idxs, fmodel=fmod, srmodel=~s(year, k=20))
res <- residuals(fit, stk, idxs)
plot(res)
plot(stk+fit)
fmod <- ~te(age, year, k = c(5, 20), bs = "tp") # + s(age, k = 3)
fit <- sca(stk, idxs, fmodel=fmod, srmodel=~s(year, k=10))
res <- residuals(fit, stk, idxs)
plot(res)
plot(stk+fit)
index(idxs[[]])
index(idxs[[1]])
index(idxs[[2]])
fit <- sca(window(stk, start=1983), idxs)#, fmodel=fmod, srmodel=~s(year, k=10))
res <- residuals(fit, stk, idxs)
plot(res)
stk <- window(stk, end=2016, start=1983)
fit <- sca(stk, idxs)#, fmodel=fmod, srmodel=~s(year, k=10))
res <- residuals(fit, stk, idxs)
plot(res)
plot(stk+fit)
plot(stk, fit)
plot(fit, stk)
plot(fit, idxs[[1]])
plot(fit, idxs)
plot(fit, idxs[1])
plot(fit, idxs[2])
plot(stk+simulate(fit, 250))
library(ggplotFL)
plot(stk+simulate(fit, 250))
plot(stk+simulate(fit, 250), probs=c(0.1,0.3,0.5,0.7,0.9))
plot(stk+simulate(fit, 250), probs=c(0.05,0.25,0.5,0.75,0.95))
SCAMCMC()
fitmc <- sca(stk, idxs, fit='mcmc', mcmc=SCAMCMC())
fitmc <- sca(stk, idxs, fit='MCMC', mcmc=SCAMCMC())
plot(stk+fitmc)
plot(stk+fit)
plot(stk+fitmc)
plot(stk+simulate(fit, 250))
x11()
plot(stk+fitmc)
fitmc <- sca(stk, idxs, fit='MCMC', mcmc=SCAMCMC(mcprobe=0.1))
plot(stk+fitmc)
fitmc <- sca(stk, idxs, fit='MCMC', mcmc=SCAMCMC(mcprobe=0.05))
plot(stk+fitmc)
fitmc <- sca(stk, idxs, fit='MCMC', mcmc=SCAMCMC(mcprobe=0.4))
plot(stk+fitmc)
plot(stk+fitmc, probs=c(0.025,0.33,0.5,0.66,0.975))
plot(stk+fitmc, probs=c(0.02,0.33,0.5,0.66,0.98))
fit
fitsep <- sca(stk, idxs, fmod=~s(age, k=5) + s(year, k=17))
ressep <- residuals(fitsep, stk, idxs)
plot(ressep)
plot(fitsep, stk)
plot(fitsep, idxs[1])
plot(fitsep, idxs[2])
plot(stk+simulate(fitsep, 250))
fitsepmc <- sca(stk, idxs, fit='MCMC', mcmc=SCAMCMC())
plot(setk+fitsepmc)
plot(stk+fitsepmc)
wireframe(data~year+age, data=harvest(fit))
wireframe(data~year+age, data=harvest(fitsep))
q()
